#!/bin/bash
# –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ cron –∑–∞–¥–∞—á–∏ –∏ –ø—Ä–∞–≤ –Ω–∞ —Å–∫—Ä–∏–ø—Ç

cd /root/rentsense || exit 1

# 1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
chmod +x git-pull-hook.sh
echo "‚úÖ –ü—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã"

# 2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å cron –∑–∞–¥–∞—á—É
echo "üìù –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ cron –∑–∞–¥–∞—á–∏..."

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –∑–∞–¥–∞—á—É —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø—É—Ç–µ–º
crontab -l 2>/dev/null | grep -v "git-pull-hook" | crontab -

# –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø—É—Ç–µ–º
(crontab -l 2>/dev/null; echo "*/5 * * * * /root/rentsense/git-pull-hook.sh >> /var/log/git-pull.log 2>&1") | crontab -

echo "‚úÖ Cron –∑–∞–¥–∞—á–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞"
echo ""
echo "–¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏ crontab:"
crontab -l
echo ""
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —Å–∫—Ä–∏–ø—Ç:"
ls -la git-pull-hook.sh
echo ""
echo "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞:"
/root/rentsense/git-pull-hook.sh

